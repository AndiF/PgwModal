/**
 * PgwModal - Version 1.0
 *
 * Copyright 2014, Jonathan M. Piat
 * http://pgwjs.com - http://pagawa.com
 * 
 * Released under the MIT license - http://opensource.org/licenses/MIT
 */
(function(a){a.pgwModal=function(g){var b={};var e={close:true,width:500,loading:"Loading in progress...",error:"An error has occured. Please try again in a few moments."};if(typeof window.pgwModalObject!="undefined"){b=window.pgwModalObject}if(typeof g=="object"){if(!g.url&&!g.target&&!g.content){throw new Error('PgwModal - There is no content to display, please provide a config parameter : "url", "target" or "content"')}b.config={};b.config=a.extend({},e,g);window.pgwModalObject=b}var i=function(){if(a("#pgwModal").length==0){var n='<div id="pgwModalWrapper"></div><div id="pgwModal"><div class="pmContainer"><div class="pmBody">';if(b.config.close){var n=n+'<a href="javascript:void(0)" class="pmClose" onclick="$.pgwModal(\'close\')"><span class="sprite flf"></span></a>'}var n=n+'<div class="pmTitle"></div><div class="pmContent cntr"></div></div></div></div>';a("body").append(n)}return true};var j=function(){a("#pgwModal .pmTitle, #pgwModal .pmContent").html("");return true};var d=function(){angular.element("body").injector().invoke(function(n){var o=angular.element(a("#pgwModal .pmContent")).scope();n(a("#pgwModal .pmContent"))(o);o.$digest()});return true};var c=function(n){a("#pgwModal .pmContent").html(n);if(b.config.angular){d()}l();return true};var l=function(){var p=a(window).height();var o=a("#pgwModal .pmBody").height();var n=Math.round((p-o)/3);if(n<=0){n=10}a("#pgwModal .pmBody").css("margin-top",n);return true};var f=function(){return b.config.modalData};var k=function(n,o){b[n]=o;window.pgwModalObject=b;return true};var m=function(){a("#pgwModal, #pgwModalWrapper").hide();a("body").removeClass("pgwModal");j();delete window.pgwModalObject;return true};var h=function(){if(b.isOpen){j()}else{i();k("isOpen",true)}if(b.config.title){a("#pgwModal .pmTitle").text(b.config.title)}if(b.config.width){a("#pgwModal .pmBody").css("max-width",b.config.width)}if(b.config.url){if(b.config.loading){a("#pgwModal .pmContent").html(b.config.loading)}var n={url:g.url,success:function(o){if(typeof o.response=="undefined"){a("#pgwModal .pmContent").html(b.config.error);return false}c(o.response)},error:function(){a("#pgwModal .pmContent").html(b.config.error)}};if(b.config.ajaxOptions){n=a.extend({},n,b.config.ajaxOptions)}a.ajax(n)}else{if(b.config.target){c(a(b.config.target).html())}else{if(b.config.content){c(b.config.content)}}}a("#pgwModal, #pgwModalWrapper").show();a("body").addClass("pgwModal");return true};if((typeof g=="string")&&(g=="close")){return m()}else{if((typeof g=="string")&&(g=="reposition")){return l()}else{if((typeof g=="string")&&(g=="getData")){return f()}else{if(typeof g=="object"){return h()}}}}}})(jQuery);
